# ec-auto-scripts

ECサイト業務を効率化するためのPythonスクリプト集です。  
商品登録や在庫管理などの手作業を自動化することで、作業負担の軽減とミスの削減を目的としています。

<br>

## 📄 スクリプト一覧

- [モールにより違う商品タイトルの統一処理（`title_rewrite_rakuten.py`）](#モールにより違う商品タイトルの統一処理)
- [買付情報をスプレッドシートに自動で記録（`rakuten_payable.py`）](#買付情報をスプレッドシートに自動で記録)
- [未連携サイトでの販売数を在庫管理を操作して自動更新（`buyma_quantity.py`）](#未連携サイトでの販売数を在庫管理を操作して自動更新)
- [未連携サイトの受注をcsvファイルで管理サイトと連携（`buyma_goq_intake.py`）](#未連携サイトの受注をcsvファイルで管理サイトと連携)
- [未連携サイトの発送完了メールを自動送信（`buyma_sent_email.py`）](#未連携サイトの発送完了メールを自動送信)

<br>

---

<br>

### 🔸モールにより違う商品タイトルの統一処理

📁 title_rewrite_rakuten.py

楽天市場の商品タイトルを自動で変換し、一括商品管理サービスGoQ（ゴクー）と整合性を取るためのスクリプト。

#### 背景

同一商品でも出店モールごとに商品タイトルの表記が異なるため、  
受注内容とGoQに登録された在庫管理情報をもとに、商品名や商品番号の整合性を取る必要がありました。  
手作業での編集は工数が大きく、変更漏れや誤配送のリスクもありました。

#### 主な機能

- 正規表現によって商品タイトルから不要な文字列を削除・置換  
- 型番や商品番号などのパターンを整形してモール間で統一された表記に書き換え  
- 処理完了済みの商品は別のステータスに自動で移動して自動で仕分け

#### 効果

- 出荷準備・在庫管理・伝票処理の作業効率が大幅に向上  
- 手動による表記違いの修正作業が不要に  
- 複数モール間での商品情報の一貫性を維持  

<br>

---

<br>

### 🔸買付情報をスプレッドシートに自動で記録

📁 rakuten_payable.py

楽天市場で受注された注文情報を取得し、受注件数と合計金額をスプレッドシートに自動記録するスクリプト。

#### 背景

スプレッドシートで手動管理していた楽天市場の受注情報を、日次でまとめて転記する作業に時間がかかっていました。
件数の確認や金額の集計、入力ミス防止が課題となっており、注文IDの重複確認や条件フィルタなど複雑な判断が必要でした。

#### 主な機能

- 楽天の管理画面から未出荷の注文データを取得し、重複を排除したうえで集計
- スプレッドシート上の過去データと照合し、既に記録された注文はスキップ
- 合計金額・注文件数・対象注文IDをログ出力し、スプレッドシートへ記録
- ユーザー・日付・モール名なども自動で付加して記録

#### 効果

- 受注件数・売上金額の記録作業を完全自動化
- 二重登録の防止や記録ミスの削減
- スプレッドシートの更新が即時反映され、業務スピードが向上

<br>

---

<br>

### 🔸未連携サイトでの販売数を在庫管理を操作して自動更新 

📁 buyma_quantity.py

BUYMAの受注内容から売れた個数と商品情報を取得して、在庫管理サイトの在庫数を自動更新するスクリプト。

#### 背景

社内で使用している一括商品管理サービスGoQ（ゴクー）は、BUYMAと連携できない仕様のため、  
BUYMAだけは手動で在庫数を更新する必要があり、作業負荷や在庫ズレの原因となっていました。

#### 主な機能

- BUYMA出品管理画面にログインして各商品の受注情報をスクレイピング 
- 受注内容の注文数と商品情報をもとにGoQの在庫管理にアクセスして自動で更新
- 受注内容をBUYMAの商品メモ欄に自動入力して保存

#### 効果

- 在庫更新作業を完全自動化  
- 作業時間を大幅に短縮し、手入力ミスを防止  
- GoQとの連携に近い動作をBUYMA単独で実現  

<br>

---

<br>

### 🔸未連携サイトの受注をcsvファイルで管理サイトと連携

📁 buyma_goq_intake.py

BUYMAの受注情報をCSVで取得し、一括商品管理サービスGoQ（ゴクー）のCSV取り込み機能を使い、
受注管理に自動で取り込むスクリプト。

#### 背景

一括商品管理サービスGoQ（ゴクー）ではBUYMAを対応しておらず、
受注内容をもとに手動で伝票処理や出荷準備を行っていたため、  
業務フローの中で処理漏れ・転記ミス・作業時間のロスが発生していました。

#### 主な機能

- BUYMAにログインし、受注内容をフィルタ・抽出  
- 対象取引のメモ欄から指定条件（※があり、＊がない）に基づき商品を選別し、選択欄にチェックをつける
- 取り込み処理をした項目がわかるように、メモ内容を自動編集し、「＊」を追記して保存  
- 選択欄にチェックが入った項目だけ、CSV書き出しをしてGoQでアップロード
- 処理結果やアラート内容はログに出力し、CSVは自動でゴミ箱に移動

#### 効果

- BUYMAとGoQ間のデータ連携を完全自動化
- 他のモールと同時に配送準備ができるため作業時間を大幅に短縮
- 転記ミスや処理忘れを防止
- 商品の状態管理や納期処理に関するトラブルを未然に防止

<br>

---

<br>

### 🔸未連携サイトの発送完了メールを自動送信

📁 buyma_sent_email.py

GoQの出荷完了情報をもとに、BUYMAの管理画面から発送完了通知を一括送信するスクリプト。

#### 背景

BUYMAでは出荷後の発送通知やメッセージ送信を手動で行う必要があり、  
発送件数が多いとメールの送り忘れや誤送信が頻発し、作業負荷が高くなっていました。

#### 主な機能

- GoQからBUYMA向けの出荷完了データを抽出
- 同梱された注文の展開と配送方法の分類
- BUYMAにログインし、「発送した」ボタンとテンプレートメールを自動送信
- 追跡番号のある／なしに応じたテンプレート切り替え
- メール送信後にGoQのステータスを自動で更新

#### 効果

- BUYMAでの発送通知業務を完全自動化
- 誤送信・追跡番号入力ミスなどの人為的エラーを削減
- 出荷後の対応を一括バッチ処理でき、業務効率が大幅向上

<br>

---

<br>

## 使用技術

- Python 3.x  
- Selenium（Webブラウザ自動操作）  
- BeautifulSoup4（HTML構造解析）  
- re（正規表現による文字列整形）  
- Google Chrome + ChromeDriver（環境自動判定付き）
- gspread（Google Sheets API操作／一部スクリプトで使用）
- pandas（CSVデータの加工や変換）※必要に応じて


<br>

## 実行方法

1. 必要なパッケージをインストール：

```bash
pip install selenium beautifulsoup4 pandas gspread oauth2client send2trash

